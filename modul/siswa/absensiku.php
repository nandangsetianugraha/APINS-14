<?php require_once '../../config/config.php';require_once '../../config/db_connect.php';$dayList = array(		'Sun' => 'Minggu',		'Mon' => 'Senin',		'Tue' => 'Selasa',		'Wed' => 'Rabu',		'Thu' => 'Kamis',		'Fri' => 'Jumat',		'Sat' => 'Sabtu'	);$kelas=$_GET['kelas'];$tanggal=$_GET['tgl'];$tapel=$_GET['tapel'];$smt=$_GET['smt'];$bulan=substr($tanggal,5,2);$tahun=substr($tanggal,0,4);$hari = cal_days_in_month(CAL_GREGORIAN, $bulan, $tahun);$day = date('D', strtotime($tanggal));$output = array('data' => array());//$sql = "select penempatan.*, absensi.* from penempatan join absensi using(peserta_didik_id) where absensi.tanggal='$tgls' and penempatan.rombel='$kelas' and penempatan.tapel='$tapel'";if($kelas==0){	$sql = "select * from penempatan where tapel='$tapel' and smt='$smt' order by rombel asc";}else{	$sql = "select * from penempatan where rombel='$kelas' and tapel='$tapel' and smt='$smt' order by nama asc";};$query = $connect->query($sql);if(namahari($tanggal)==="Sabtu" || namahari($tanggal)==="Minggu"){	$output['data'][] = array(				'Hari '.namahari($tanggal).' tidak boleh absen',				'',				''			);}else{	while($s=$query->fetch_assoc()) {		$idp=$s['peserta_didik_id'];		$sql1 = "select * from siswa where peserta_didik_id='$idp'";		$query1 = $connect->query($sql1);		$m=$query1->fetch_assoc();		$cekabsen=$connect->query("select * from absensi where tanggal='$tanggal' and peserta_didik_id='$idp' and tapel='$tapel' and smt='$smt' and kelas='$kelas'")->num_rows;		if($cekabsen>0){			$absens=$connect->query("select * from absensi where tanggal='$tanggal' and peserta_didik_id='$idp' and tapel='$tapel' and smt='$smt' and kelas='$kelas'")->fetch_assoc();			$ida=$absens['id_absen'];			$ncek=$absens['absensi'];			if($ncek=='S'){				$stat1='checked=""';				$stat2='';				$stat3='';			}elseif($ncek=='I'){				$stat1='';				$stat2='checked=""';				$stat3='';			}else{				$stat1='';				$stat2='';				$stat3='checked=""';			};			$tombol = '			<div class="btn-group">			<button class="btn btn-xs btn-icon btn-danger" onclick="removeAbsen(\''.$ida.'\')" id="hapusAbsen"><i class="fa fa-trash"></i></button>			</div>';			$butt='			<form class="row gx-3 gy-2 align-items-center">				<div class="col-auto">					<div class="radio-custom radio-primary">						<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'S\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat1.'>						<label for="radioExample2">Sakit</label>					</div>				</div>				<div class="col-auto">					<div class="radio-custom radio-success">						<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'I\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat2.'>						<label for="radioExample3">Ijin</label>					</div>				</div>				<div class="col-auto">					<div class="radio-custom radio-warning">					<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'A\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat3.'>					<label for="radioExample4">Alpa</label>				</div>				</div>			</form>									';			$output['data'][] = array(				$m['nama'],				$butt,				$tombol			);		}else{			$stat1='';			$stat2='';			$stat3='';			$tombol = '';			$butt='			<form class="row gx-3 gy-2 align-items-center">				<div class="col-auto">					<div class="radio-custom radio-primary">						<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'S\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat1.'>						<label for="radioExample2">Sakit</label>					</div>				</div>				<div class="col-auto">					<div class="radio-custom radio-success">						<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'I\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat2.'>						<label for="radioExample3">Ijin</label>					</div>				</div>				<div class="col-auto">					<div class="radio-custom radio-warning">					<input onClick="saveAbsen(\''.$tanggal.'\',\''.$idp.'\',\''.$tapel.'\',\''.$smt.'\',\''.$kelas.'\',\'A\')" type="radio" id="absen-'.$idp.'" name="absen-'.$idp.'" '.$stat3.'>					<label for="radioExample4">Alpa</label>				</div>				</div>			</form>			';			$output['data'][] = array(				$m['nama'],				$butt,				$tombol			);		};	};};$connect->close();echo json_encode($output);