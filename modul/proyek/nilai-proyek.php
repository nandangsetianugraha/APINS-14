<?phprequire_once '../../config/db_connect.php';
$kelas=$_GET['kelas'];$proyek=$_GET['proyek'];$tapel=$_GET['tapel'];$smt=$_GET['smt'];$siswa=$_GET['siswa'];
$ab=substr($kelas,0,1);if($ab==1 or $ab==2){	$fase="A";}elseif($ab==3 or $ab==4){	$fase="B";}else{	$fase="C";};$sql = "select * from pemetaan_proyek where proyek='$proyek' group by dimensi";$query = $connect->query($sql);//$mapel=$connect->query("select * from mata_pelajaran where id_mapel='$mp'")->fetch_assoc();	while($s=$query->fetch_assoc()) {		$iddimensi=$s['dimensi'];		//$elemen=$s['elemen'];		$ndimensi=$connect->query("select * from dimensi_proyek where id_dimensi='$iddimensi'")->fetch_assoc();		$nomor=1;	?>	<h2>Dimensi : <?=$ndimensi['nama_dimensi'];?></h2>	<table class="table table-striped table-borderless table-vcenter">        <thead>            <tr>                <th>No</th>				<th>Capaian</th>            </tr>        </thead>        <tbody>			<?php 			$sql1 = "select * from pemetaan_proyek where proyek='$proyek' and dimensi='$iddimensi' order by elemen asc";			$query1 = $connect->query($sql1);			while($n=$query1->fetch_assoc()) {				$iddimensi=$n['dimensi'];				$idel=$n['elemen'];				$ada = $connect->query("select * from penilaian_proyek where peserta_didik_id='$siswa' AND kelas='$kelas' AND smt='$smt' AND tapel='$tapel' AND proyek='$proyek' and id_elemen='$idel'")->num_rows;				$m=$connect->query("select * from elemen_proyek where id_elemen='$idel'")->fetch_assoc();				if($ada>0){					$utt=$connect->query("select * from penilaian_proyek where peserta_didik_id='$siswa' AND kelas='$kelas' AND smt='$smt' AND tapel='$tapel' AND proyek='$proyek' and id_elemen='$idel'")->fetch_assoc();					$ncek=$utt['nilai'];					if($ncek==0){						$stat1='checked';						$stat2='';						$stat3='';						$stat4='';					}elseif($ncek==1){						$stat1='';						$stat2='checked';						$stat3='';						$stat4='';					}elseif($ncek==2){						$stat1='';						$stat2='';						$stat3='checked';						$stat4='';					}else{						$stat1='';						$stat2='';						$stat3='';						$stat4='checked';					};				}else{					$stat1='';					$stat2='';					$stat3='';					$stat4='';				};			?>			<tr>				<td><?=$nomor;?></td>				<td>				<strong><?=$m['sub_elemen'];?></strong><br/>				<i class="text-primary"><?=$m['capaian'];?></i><br/>				<div class="row">					<div class="col-3">					<input onClick="savePilihan('<?=$siswa;?>','<?=$kelas;?>','<?=$tapel;?>','<?=$smt;?>','<?=$proyek;?>','<?=$idel;?>','<?=$iddimensi;?>','0')" class="form-check-input" type="radio" id="example-<?=$idel;?>-default1" name="pilihan-<?=$idel;?>" value="0" <?=$stat1;?>>					<label for="radioExample1"><span class="badge badge-danger badge-square">BB</span></label>					</div>					<div class="col-3">					<input onClick="savePilihan('<?=$siswa;?>','<?=$kelas;?>','<?=$tapel;?>','<?=$smt;?>','<?=$proyek;?>','<?=$idel;?>','<?=$iddimensi;?>','1')" class="form-check-input" type="radio" id="example-<?=$idel;?>-default1" name="pilihan-<?=$idel;?>" value="1" <?=$stat2;?>>					<label for="radioExample1"><span class="badge badge-warning badge-square">MB</span></label>					</div>					<div class="col-3">					<input onClick="savePilihan('<?=$siswa;?>','<?=$kelas;?>','<?=$tapel;?>','<?=$smt;?>','<?=$proyek;?>','<?=$idel;?>','<?=$iddimensi;?>','2')" class="form-check-input" type="radio" id="example-<?=$idel;?>-default1" name="pilihan-<?=$idel;?>" value="2" <?=$stat3;?>>					<label for="radioExample1"><span class="badge badge-success badge-square">BSH</span></label>					</div>					<div class="col-3">					<input onClick="savePilihan('<?=$siswa;?>','<?=$kelas;?>','<?=$tapel;?>','<?=$smt;?>','<?=$proyek;?>','<?=$idel;?>','<?=$iddimensi;?>','3')" class="form-check-input" type="radio" id="example-<?=$idel;?>-default1" name="pilihan-<?=$idel;?>" value="3" <?=$stat4;?>>					<label for="radioExample1"><span class="badge badge-primary badge-square">BSB</span></label>					</div>				</div>				</td>															</tr>			<?php 			$nomor=$nomor+1;			}			?>			                          </tbody>    </table>		<?php };
?><br/><br/><h4>Catatan Proses</h4>	<?php 	$catatans=$connect->query("select * from simpulan_proyek where peserta_didik_id='$siswa' and kelas='$kelas' and tapel='$tapel' and smt='$smt' and proyek='$proyek'")->fetch_assoc();	$tng = $catatans['simpulan'];	echo '	<span class="textarea form-control form-control-sm"  contenteditable="true" data-old_value="'.$tng.'"  onBlur="simpanproyek(this,\'simpulan\',\''.$siswa.'\',\''.$kelas.'\',\''.$smt.'\',\''.$tapel.'\',\''.$proyek.'\')" onClick="highlightEdit(this);">'.$tng.'</span>	';	?><script>	$("#tpTable").DataTable({pageLength:30,lengthMenu:[[10,20,30],[10,20,30]],autoWidth:!1,responsive: true});		function highlightEdit(editableObj) {		$(editableObj).css("background","#FFF0000");	} 	function simpanproyek(editableObj,column,id,kelas,smt,tapel,proyek) {		// no change change made then return false		if($(editableObj).attr('data-old_value') === editableObj.innerHTML)		return false;		// send ajax to update value		$(editableObj).css("background","#FFF url(loader.gif) no-repeat right");		$.ajax({			url: "modul/proyek/savePres.php",			cache: false,			data:'column='+column+'&value='+editableObj.innerHTML+'&id='+id+'&kelas='+kelas+'&smt='+smt+'&tapel='+tapel+'&proyek='+proyek,			success: function(response)  {				console.log(response);				// set updated value as old value				$(editableObj).attr('data-old_value',editableObj.innerHTML);				$(editableObj).css("background","#FFF url(checkup.png) no-repeat right");							}          	   });	}</script>