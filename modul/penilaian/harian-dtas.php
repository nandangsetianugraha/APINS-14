<?phprequire_once '../../config/db_connect.php';
$kelas=$_GET['kelas'];$mp=$_GET['mp'];//$materi=$_GET['materi'];$tapel=$_GET['tapel'];$smt=$_GET['smt'];
$ab=substr($kelas,0,1);$output = array('data' => array());if($tapel_aktif==$tapel and $smt_aktif==$smt){	$edit=true;}else{	$edit=false;};$sql = "select * from penempatan where tapel='$tapel' and smt='$smt' and rombel='$kelas' order by nama asc";$query = $connect->query($sql);$mapel=$connect->query("select * from mapel_dta where id_mapel='$mp'")->fetch_assoc();$ada = $connect->query("select * from materi_dta where kelas='$ab' AND smt='$smt' AND mapel='$mp'")->num_rows;if($mp==0){}else{	if($ada>0){?><div class="table-responsive"><table class="table table-striped table-hover mb-0">	<thead>		<tr>			<th rowspan="2">Nama</th>			<?php 			$sql3 = "select * from materi_dta where kelas='$ab' AND smt='$smt' AND mapel='$mp' order by lm asc";			$query3 = $connect->query($sql3);			while($sm=$query3->fetch_assoc()) {			?>			<th colspan="2">Materi <?=$sm['lm'];?></th>			<?php } ?>		</tr>		<tr>			<?php 			$sql31 = "select * from materi_dta where kelas='$ab' AND smt='$smt' AND mapel='$mp' order by lm asc";			$query31 = $connect->query($sql31);			while($sm1=$query31->fetch_assoc()) {			?>			<th>Tulis</th>			<th>Tugas</th>			<?php } ?>		</tr>	</thead>	<tbody><?php while($s=$query->fetch_assoc()) {	$idp=$s['peserta_didik_id'];	$siswa=$connect->query("select * from siswa where peserta_didik_id='$idp'")->fetch_assoc();	$sql2 = "select * from materi_dta where kelas='$ab' and smt='$smt' and mapel='$mp' order by lm asc";	$query2 = $connect->query($sql2);?>		<tr>			<td><?=$s['nama'];?></td><?php 	while($sl=$query2->fetch_assoc()) {		$materi=$sl['lm'];		$sql1 = "select * from nh_dta where id_pd='$idp' and smt='$smt' and tapel='$tapel' and mapel='$mp' and materi='$materi' and jns='tls'";		$nh = $connect->query($sql1);		$m=$nh->fetch_assoc();		if(empty($m['nilai'])){			$nHar='';		}else{			$nHar=number_format($m['nilai'],0);		};		$sql2 = "select * from nh_dta where id_pd='$idp' and smt='$smt' and tapel='$tapel' and mapel='$mp' and materi='$materi' and jns='tgs'";		$nh2 = $connect->query($sql2);		$m2=$nh2->fetch_assoc();		if(empty($m2['nilai'])){			$nHar2='';		}else{			$nHar2=number_format($m2['nilai'],0);		};		$tulis = '		<span class="input form-control form-control-sm" contenteditable="true" data-old_value="'.$nHar.'"  onBlur="saveSumatif(this,\'nilai\',\''.$idp.'\',\''.$ab.'\',\''.$smt.'\',\''.$tapel.'\',\''.$mp.'\',\''.$materi.'\',\'tls\')" onClick="highlightEdit(this);">'.$nHar.'</span>		';		$tugas = '		<span class="input form-control form-control-sm" contenteditable="true" data-old_value="'.$nHar2.'"  onBlur="saveSumatif(this,\'nilai\',\''.$idp.'\',\''.$ab.'\',\''.$smt.'\',\''.$tapel.'\',\''.$mp.'\',\''.$materi.'\',\'tgs\')" onClick="highlightEdit(this);">'.$nHar2.'</span>		';?>			<td><?=$tulis;?></td><td><?=$tugas;?></td><?php 	};?>		</tr><?php };?>	</tbody></table></div><?php 	}else{?><div class="alert alert-primary"><div class="alert-icon"><i class="fa fa-archive"></i></div><div class="alert-content">Belum Ada Materi</div></div><?php 	};};?>